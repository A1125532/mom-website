<!-- contact.html -->
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é™³æƒ…è¡¨å–® - é™³é›…æƒ è­°å“¡æœå‹™åœ˜éšŠ</title>
  <link rel="stylesheet" href="shared/topbar.css">
  <style>
    /* ä¿ç•™ body åº•è‰²èˆ‡å­—é«”ï¼Œé¿å…å£“æ‰ topbar.css çš„ padding-top */
    body{
      font-family: Arial, sans-serif;
      background:#f9f9f9;
      padding-top: calc(var(--topbarH) + 5px) !important;
    }
    /* ç”¨ .page åŒ…å…§å®¹ï¼Œæ‰¿æ¥åŸæœ¬çš„ margin/padding */
    .page{
      max-width:600px;
      margin:0 auto;
      padding:2em;
    }

    h1{ text-align:center; color:#00993d; }

    .page form{
      background:#fff;
      padding:1.5em;
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,.1);
    }
    .page form label{
      display:block; margin-top:1em; font-weight:bold;
    }
    .page form input,
    .page form textarea,
    .page form select{
      width:100%; padding:.6em; margin-top:.3em;
      border:1px solid #ccc; border-radius:5px;
      font:inherit;
    }
    .page form button{
      margin-top:1.5em;
      padding:.8em;
      background:#00993d;
      color:#fff;
      border:none;
      border-radius:5px;
      width:100%;
      font-size:1em;
      cursor:pointer;
      transition:background .3s ease, transform .2s ease;
    }
    .page form button:hover{
      background:#007a30;
      transform:scale(1.02);
    }

    .sending-text{
      text-align:center; color:#666;
      font-weight:bold; margin-top:1em;
      display:none; animation:fadeIn .6s ease-in-out;
    }
    @keyframes fadeIn{
      from{ opacity:0; transform:translateY(10px);}
      to{ opacity:1; transform:translateY(0);}
    }

    .page footer{
      text-align:center;
      margin-top:2em;
      color:#777;
      font-size:.9em;
    }
  </style>
</head>
<body>

  <!-- é€™å€‹å ä½æœƒè¢«æ›¿æ›æˆå…±ç”¨çš„ç¶ è‰²å°è¦½åˆ— -->
  <div id="topbar-mount"></div>

  <script>
    (function () {
      const mountId = 'topbar-mount';
      const prefixes = ['shared/', './shared/', '../shared/', '/shared/'];
      async function tryLoad() {
        for (const p of prefixes) {
          try {
            const res = await fetch(p + 'topbar.html', { cache: 'no-store' });
            if (!res.ok) continue;
            const html = await res.text();
            const mount = document.getElementById(mountId);
            if (!mount) return;
            mount.outerHTML = html;
            const s = document.createElement('script');
            s.src = p + 'topbar.js';
            document.body.appendChild(s);
            if (!document.querySelector('link[href*="topbar.css"]')) {
              const link = document.createElement('link');
              link.rel = 'stylesheet';
              link.href = p + 'topbar.css';
              document.head.appendChild(link);
            }
            return;
          } catch(e){}
        }
        const mount = document.getElementById(mountId);
        if (mount) {
          mount.innerHTML = '<div style="background:#fee;border:1px solid #f99;color:#900;padding:10px;border-radius:8px;">' +
            'ç„¡æ³•è¼‰å…¥ <code>shared/topbar.html</code>ã€‚è«‹ç¢ºèªè·¯å¾‘æˆ–ä»¥ä¼ºæœå™¨æ–¹å¼é–‹å•Ÿ' +
            '</div>';
        }
      }
      tryLoad();
    })();
  </script>

  <div class="page">
    <h1>ğŸ“¬ é™³æƒ…è¡¨å–®</h1>
    <p style="text-align:center;">
      è«‹ç•™ä¸‹æ‚¨çš„è¯çµ¡è³‡è¨Šèˆ‡éœ€æ±‚<br>
      æ‚¨å¯æ–¼æœå‹™å¹³å°é¦–é é»é¸ã€ŒğŸ” æ¡ˆä»¶é€²åº¦æŸ¥è©¢ã€æŸ¥çœ‹æ¡ˆä»¶é€²åº¦
    </p>

    <form id="petitionForm">
      <!-- æ³¨æ„äº‹é …å€å¡Š -->
      <section style="background:#fff0f0;border:1px solid #ffcccc;padding:1em;margin-bottom:2em;">
        <h3 style="color:#cc0000;text-align:left;">âš  æ³¨æ„äº‹é …</h3>
        <p style="margin-top:0.5em; margin-bottom:1em; color:#cc0000; font-weight:bold; font-size:1.17em; line-height:1.4;">
          <strong>è«‹æ‚¨å…ˆè©³è®€ä¸‹åˆ—èªªæ˜å¾Œå†ç™»éŒ„æ¡ˆä»¶</strong>
        </p>
        <ol style="padding-left:1.2em;text-align:left;">
          <li>ã€*ã€æ¬„ä½å‹™å¿…è¼¸å…¥ã€‚</li>
          <li>æª¢èˆ‰äººåŸºæœ¬è³‡æ–™å°‡æ¡ä¿å¯†æ–¹å¼è™•ç†ï¼Œä½†å› æ¥­å‹™éœ€è¦ï¼Œæ‰¿è¾¦æ©Ÿé—œå¾—èª¿é–±é™³æƒ…äººåŸºæœ¬è³‡æ–™ä»¥ä¾›è™•ç†ã€‚</li>
          <li>å…§å®¹æ‡‰å…·é«”åˆ—èˆ‰äº‹è­‰ï¼Œå¦å‰‡å°‡ä¸äºˆè™•ç†æˆ–ä¸äºˆå—ç†ã€‚</li>
          <li>èˆ‡å¸‚æ”¿ç„¡é—œå»ºè­°ã€è¬¾ç½µã€æƒ¡æ„æ”»æ“Šå°‡ä¸äºˆè™•ç†ã€‚</li>
          <li style="color:#cc0000;"><strong>è‹¥å§“åã€åœ°å€ã€è¯çµ¡è³‡æ–™è™›å ±ï¼Œå°‡ä¸äºˆè™•ç†ã€‚</strong></li>
        </ol>
        <div style="margin-top:1em;display:flex;align-items:center;">
          <label for="agree" style="display:flex;align-items:center;">
            <input type="checkbox" id="agree" name="agree" required style="margin-right:.5em;">
            <span style="white-space:nowrap;">æˆ‘å·²é–±è®€æ³¨æ„äº‹é …ä¸¦åŒæ„</span>
          </label>
        </div>
      </section>

      <!-- å…¶é¤˜æ¬„ä½ç…§èˆŠ -->
      <input type="hidden" name="æ¡ˆä»¶ç·¨è™Ÿ" id="caseIdInput">
      <label for="name">å§“å *</label>
      <input type="text" id="name" name="å§“å" required>

      <label for="gender">æ€§åˆ¥ *</label>
      <select id="gender" name="æ€§åˆ¥" required>
        <option value="">è«‹é¸æ“‡</option>
        <option value="ç”·å£«">ç”·å£«</option>
        <option value="å¥³å£«">å¥³å£«</option>
      </select>

      <label for="phone">è¯çµ¡é›»è©± *</label>
      <input type="tel" id="phone" name="é›»è©±" required>

      <label for="mailing">é€šè¨Šåœ°å€ *</label>
      <input type="text" id="mailing" name="é€šè¨Šåœ°å€" required>

      <label for="email">é›»å­ä¿¡ç®± *</label>
      <input type="email" id="email" name="é›»å­ä¿¡ç®±" required>

      <label for="region">æ¡ˆä»¶ç™¼ç”Ÿè¡Œæ”¿å€ *</label>
      <select id="region" name="è¡Œæ”¿å€" required>
        <option value="">è«‹é¸æ“‡</option>
        <option value="æ±å€">æ±å€</option>
        <option value="å—å€">å—å€</option>
        <option value="è·¨å€">è·¨å€</option>
        <option value="ä¸æ˜">ä¸æ˜</option>
      </select>

      <label for="address">æ¡ˆä»¶ç™¼ç”Ÿåœ°å€ *</label>
      <input type="text" id="address" name="è©³ç´°åœ°å€" required>

      <label for="landmark">åœ°æ¨™ï¼ˆå¦‚ï¼šXXä¾¿åˆ©å•†åº—æ—ã€XXå¸‚å ´å°é¢ï¼‰ï¼ˆé¸å¡«ï¼‰</label>
      <input type="text" id="landmark" name="åœ°æ¨™">

      <label for="message">é™³æƒ…å…§å®¹ *</label>
      <textarea id="message" name="é™³æƒ…å…§å®¹" rows="6" required></textarea>

      <label for="note">è£œå……èªªæ˜ï¼ˆé¸å¡«ï¼‰</label>
      <textarea id="note" name="è£œå……èªªæ˜" rows="4"></textarea>

      <label style="margin-top:1em;">ç›¸é—œé™„ä»¶</label>
      <p style="margin-top:.3em;font-size:.9em;color:#555;">
        è‹¥éœ€è¦é™„åŠ æª”æ¡ˆï¼Œè«‹åœ¨æ”¶åˆ°è¼‰æœ‰ã€Œæ¡ˆä»¶ç·¨è™Ÿã€çš„ç¢ºèªéƒµä»¶å¾Œï¼Œ<br>
        ç›´æ¥å›è¦†è©²å° Gmail ä¸¦é™„ä¸Šæª”æ¡ˆï¼Œæˆ‘å€‘å°‡å”åŠ©æ­¸æª”è™•ç†ã€‚
      </p>

      <button type="submit">é€å‡ºè¡¨å–®</button>
    </form>

    <p class="sending-text" id="sendingText">å¯„ä»¶ä¸­ï¼Œè«‹ç¨ç­‰...</p>

    <footer>
      Â© é™³é›…æƒ è­°å“¡æœå‹™åœ˜éšŠ<br>
      æœå‹™è™•åœ°å€:å°ä¸­å¸‚å—å€æ­£ç¾©è¡—236è™Ÿ<br>
      è¯çµ¡é›»è©±ï¼š04-2282-4639
    </footer>
  </div>

  <script>
  document.getElementById("petitionForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const form = e.target;
    const fd   = new FormData(form);
    const sendingText = document.getElementById("sendingText");
    sendingText.style.display = "block";

    const rand  = Math.random().toString(36).slice(2, 5).toUpperCase();
    const now = new Date();
    const yyyy = now.getFullYear();
    const mm = String(now.getMonth() + 1).padStart(2, '0');
    const dd = String(now.getDate()).padStart(2, '0');
    const today = `${yyyy}${mm}${dd}`;
    const caseId = `${rand}-${today}`;
    fd.set("æ¡ˆä»¶ç·¨è™Ÿ", caseId);
    document.getElementById("caseIdInput").value = caseId;

    const gsFd = new FormData();
    gsFd.append("æ¡ˆä»¶ç·¨è™Ÿ", caseId);
    gsFd.append("é›»å­ä¿¡ç®±", form.email.value);
    gsFd.append("æ¡ˆä»¶ç‹€æ…‹", "å·²æ”¶ä»¶");
    gsFd.append("å‚™è¨»", "ç„¡");

    fetch("https://script.google.com/macros/s/AKfycbz4TUYV8xSV2cTCTnUR9yiofZkObZ-HCSUx0MfyXnhMysmic71NRPyZUpwVI8kHsQfn/exec", {
      method:"POST", mode:"no-cors", body:gsFd
    });

    try {
      const rsp = await fetch("https://script.google.com/macros/s/AKfycbyF0S5i8CDlN1DS95gbx24SBAF-rNhdCpds_36MHTWe7jNS_KmUdB_b9O4o_C2nUuCR4A/exec", {
        method:"POST", body:fd
      });
      if (rsp.ok) {
        window.location.href = "thankyou.html?caseId=" + encodeURIComponent(caseId);
      } else {
        const err = await rsp.json().catch(() => ({}));
        alert("é€å‡ºå¤±æ•—ï¼š" + (err.error || "è«‹ç¨å¾Œå†è©¦"));
        sendingText.style.display = "none";
      }
    } catch (err) {
      alert("é€å‡ºå¤±æ•—ï¼Œè«‹ç¢ºèªç¶²è·¯æˆ–ç¨å¾Œå†è©¦ï¼");
      sendingText.style.display = "none";
      console.error(err);
    }
  });
  </script>

</body>
</html>


