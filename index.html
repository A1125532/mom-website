<!-- index.html -->
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <!-- =========================
    <head>：字體、RWD、SEO
  ========================== -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="歡迎造訪陳雅惠議員的服務平台，提供線上陳情、進度查詢、政策建議、法律諮詢、常見問題解答與 Facebook、Line、Instagram 等社群資訊，亦可看到雅惠的政策主張與為里民爭取的事項，為民眾提供即時互動與關懷。" />
  <meta name="keywords" content="議員, 陳情, 民意, 服務, 地方政治, 反映問題, 陳雅惠議員" />
  <meta name="google-site-verification" content="U1o1YtwwNO0o7hcKCeRV-T9cjR2n-uNVkJxao8ODzS8" />
  <meta name="google-site-verification" content="8HMs7LlgUHkwUll3MveO6eHoZbos3lUZ4tXozo_m8Bc" />
  <title>陳雅惠議員 - 民意交流與服務平台</title>

  <!-- 字體 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet" />

  <!-- ✅ 共用 topbar 樣式（固定導覽列、手機抽屜、遮罩、間距都在這裡處理） -->
  <link rel="stylesheet" href="shared/topbar.css">
  
  <style>
  /* --- 本頁專屬主題變數（供卡片/陰影使用）--- */
  :root{
    --primary:#00993d; --accent:#e303a4;
    --radius:14px; --shadow:0 2px 10px rgba(0,0,0,.12);
  }

  /* --- Reset 與基礎排版（避免與共用 topbar 重複，僅保留必要） --- */
  *{box-sizing:border-box;margin:0;padding:0}
  html, body { height:100%; }
  body{
    min-height:100svh; display:flex; flex-direction:column;
    font-family:'Noto Sans TC',sans-serif; color:#222; background:#fff;
  }
  main{ flex:1; }
  a{ color:inherit; text-decoration:none; }

  /* =========================
    Hero 輪播
  ========================== */
  .hero-wrap{max-width:1200px;margin:20px auto;padding:0 16px}
  .carousel{
    position:relative; overflow:hidden; border-radius:20px; box-shadow:0 12px 30px rgba(0,0,0,.12);
    aspect-ratio:16/7.95; background:#ddd; /* 改照片上下寬度 */
  }
  .slide{position:absolute; inset:0; opacity:0; transition:opacity .6s ease}
  .slide img{width:100%; height:100%; object-fit:cover; display:block}
  .slide.active{opacity:1}
  .slide .label{
    position:absolute; top:14px; left:14px;
    background:rgba(255,255,255,.95); color:#17583a; border:1px solid rgba(0,0,0,.08);
    padding:6px 10px; border-radius:999px; font-weight:700; font-size:.92rem;
  }
  .slide .caption{
    position:absolute; left:0; right:0; bottom:0;
    background:linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.5) 70%);
    color:#fff; padding:30px 18px 16px; font-size:1rem; line-height:1.5;
  }
  .ctrl{
    position:absolute; top:50%; transform:translateY(-50%);
    background:rgba(0,0,0,.45); color:#fff; border:none; width:44px; height:44px; border-radius:50%;
    display:grid; place-items:center; cursor:pointer;
  }
  .ctrl:hover{background:rgba(0,0,0,.65)}
  .ctrl.prev{left:12px} .ctrl.next{right:12px}
  .dots{position:absolute; left:0; right:0; bottom:10px; display:flex; justify-content:center; gap:8px}
  .dot{width:10px;height:10px;border-radius:50%;background:rgba(255,255,255,.6);border:1px solid rgba(0,0,0,.2);cursor:pointer}
  .dot.active{background:#fff}

  /* =========================
    最新公告（桌機 3 欄；手機 1 欄）
  ========================== */
  .section{max-width:1200px;margin:20px auto;padding:0 16px}
  .bulletin h2{margin:4px 0 12px;color:#165a2e}
  .bgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}

  /* 卡片 */
  .news{
    display:block; background:#fff; border-radius:12px;
    box-shadow:var(--shadow); padding:14px 16px; color:inherit;
  }
  a.news{ transition:transform .15s ease, box-shadow .15s ease, background .15s ease; cursor:pointer; }
  a.news:hover{ transform:translateY(-2px); box-shadow:0 10px 24px rgba(0,0,0,.18); }
  a.news:active{ transform:translateY(-1px) scale(.998); }
  a.news:focus-visible{ outline:3px solid #1b5e3a; outline-offset:2px; }
  .news.is-static{ cursor:default; }

  .badge{display:inline-block;background:#eaf8ef;color:#0a7a36;border:1px solid #bfe7cc;border-radius:999px;padding:3px 8px;font-size:.82rem;margin-bottom:6px}
  .news .title{ font-weight:700; color:#1b5e3a; }
  .news .desc{ font-size:.9rem; color:#444; line-height:1.5; margin-top:6px; }
  .meta{font-size:.86rem;color:#666;margin-top:4px}

  /* 最新公告下方的小提示文案 */
  .bulletin .bulletin-tip{
    font-size:.95rem;
    color:#555;
    line-height:1.6;
    margin: -2px 0 10px;  /* 與標題、控制列的間距 */
  }

  /* === Bulletin 控制列（搜尋 + 篩選） === */
  .bulletin .controls{
    display:flex; gap:12px; align-items:center; margin:10px 0 14px;
    flex-wrap:wrap;
  }
  .bulletin .search-wrap{
    position:relative; flex:1 1 420px; max-width:720px;
  }
  .bulletin .search-wrap input{
    width:100%; font-size:16px; padding:12px 16px 12px 44px;
    border:1px solid #ddd; border-radius:12px; outline:none;
    box-shadow:0 2px 8px rgba(0,0,0,.06) inset; transition:border .2s ease;
  }
  .bulletin .search-wrap input:focus{ border-color:#00993d; }
  .bulletin .search-wrap .icon{
    position:absolute; left:14px; top:50%; transform:translateY(-50%);
    pointer-events:none; font-size:18px;
  }
  .bulletin .filter{
    min-width:110px; font-size:16px; padding:10px 12px;
    border:1px solid #111; border-radius:12px; background:#fff; cursor:pointer;
  }

  /* === 分頁 === */
  .pager{
    display:flex; gap:10px; align-items:center; justify-content:center;
    margin:20px 0 6px;
  }
  .page-btn, .page-nav{
    display:inline-grid; place-items:center; min-width:44px; height:44px;
    padding:0 12px; border-radius:6px; background:#cc0092; color:#fff; cursor:pointer;
    border:none; font-size:16px; user-select:none;
  }
  .page-num{
    display:inline-grid; place-items:center; min-width:36px; height:36px;
    font-size:16px; padding:0 8px; border-radius:6px; cursor:pointer; border:1px solid transparent;
  }
  .page-num.active{ background:#cc0092; color:#fff; }
  .page-num:hover{ border-color:#cc0092; }
  .pager .ellipsis{ padding:0 4px; color:#666; }

  /* =========================
    Footer
  ========================== */
  footer{
    background:#333;color:#fff;text-align:center;padding:16px;
    line-height:1.6;font-size:.95em; margin-top:auto;
  }

  /* =========================
    手機樣式（≤900px）：
    - 公告 1 欄
  ========================== */
  @media (max-width:900px){
    .bgrid{ grid-template-columns:1fr; }
    .page-btn{ min-width:40px; height:40px; }
    .page-num{ min-width:32px; height:32px; }
  }
  </style>
</head>
<body>

  <!-- ✅ 只保留 mount；實際導覽列由下方腳本注入 -->
  <div id="topbar-mount"></div>

  <main>
    <!-- =========================
      Hero 輪播
    ========================== -->
    <section class="hero-wrap" aria-label="重點照片">
      <div class="carousel" id="carousel">
        <div class="slide active">
          <img src="images/slide1.jpg" alt="服務處外觀">
          <span class="label">陳雅惠議員</span>
          <div class="caption">傾聽每一個聲音，守護在地的每一天。</div>
        </div>
        <div class="slide">
          <img src="images/slide2.jpg" alt="議會質詢片段">
          <span class="label">議會質詢片段</span>
          <div class="caption">針對民生、交通、教育等議題積極監督與建言，爭取在地建設。</div>
        </div>
        <div class="slide">
          <img src="images/slide3.jpg" alt="里內活動合照">
          <span class="label">社區活動</span>
          <div class="caption">與里民一起參與環境清潔、關懷長者等活動，連結社區向心力。</div>
        </div>

        <button class="ctrl prev" aria-label="上一張" id="prev">&#10094;</button>
        <button class="ctrl next" aria-label="下一張" id="next">&#10095;</button>
        <div class="dots" id="dots"></div>
      </div>
    </section>

    <!-- =========================
      最新公告（已加入搜尋、分類、分頁）
    ========================== -->
    <section class="section bulletin" id="bulletin">
      <h2>📣 最新公告</h2>

      <!-- 說明文（放在 h2 下面、controls 上面） -->
       <p class="bulletin-tip">
        🔍 可輸入關鍵字（如：法律、颱風），並搭配分類選單（如：服務處公告、民生）快速查詢相關資訊。
       </p>

      <!-- 控制列：搜尋 + 分類 -->
      <div class="controls" aria-label="公告搜尋與分類">
        <div class="search-wrap">
          <span class="icon">🔍</span>
          <input id="bulletin-search" type="search" placeholder="輸入關鍵字查詢" aria-label="輸入關鍵字查詢">
        </div>
        <select id="bulletin-filter" class="filter" aria-label="分類篩選">
          <option value="全部" selected>全部</option>
          <option value="服務處公告">服務處公告</option>
          <option value="議會 / 政策">議會 / 政策</option>
          <option value="民生">民生</option>
          <option value="交通 / 在地建設">交通 / 在地建設</option>
          <option value="教育">教育</option>
          <option value="公共安全">公共安全（自然災害、防疫、治安...）</option>
          <option value="政治參與">政治參與</option>
          <!-- 需要更多分類就自行加 option -->
        </select>
      </div>

      <!-- 卡片清單（請為每張卡片加上 data-category，逗號分隔可多分類） -->
      <div class="bgrid" id="bulletin-list">
        <!-- 非連結的卡片 -->
        <div class="news is-static" data-category="服務處公告">
          <span class="badge">服務處公告</span>
          <div class="title">每週五服務處提供免費法律諮詢服務</div><br>
          <div class="desc">生活遇到法律問題需要幫助嗎？我們提供免費初步諮詢，協助您釐清權益與對策。<br><br>
            👉 想了解更多，請到「⚖️ 法律諮詢」頁面查看！
          </div><br>
          <div class="meta">2025-08-29 · 陳雅惠議員服務處</div>
        </div>

        <!-- 可點連結的卡片 -->
        <a class="news" href="https://www.upmedia.mg/news_info.php?Type=24&SerialNo=237839"
         target="_blank" rel="noopener noreferrer" data-category="議會 / 政策,民生">
          <span class="badge">議會 / 政策</span>
          <span class="badge">民生</span>
          <div class="title">綠議員指台中超徵75億元應「還稅於民」　中市府駁：近6年短絀9億元</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-08-19 · 上報快訊／鍾知諭</div>
        </a>
        
        <a class="news" href="https://tw.news.yahoo.com/%E6%A5%8A%E6%9F%B3%E9%A2%B1%E9%A2%A8%E4%BE%86%E8%A5%B2-%E4%B8%AD%E5%B8%82%E8%AD%B0%E5%93%A1%E7%B1%B2%E9%9B%B6%E6%AD%BB%E8%A7%92%E9%98%B2%E6%B1%9B-063148946.html"
         target="_blank" rel="noopener noreferrer" data-category="公共安全">
          <span class="badge">公共安全</span>
          <div class="title">楊柳颱風來襲 中市議員籲零死角防汛</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-08-13 · 諸葛志一</div>
        </a>

        <a class="news" href="https://www.epochtimes.com/b5/25/8/11/n14571313.htm"
         target="_blank" rel="noopener noreferrer" data-category="議會 / 政策,民生">
          <span class="badge">議會 / 政策</span>
          <span class="badge">民生</span>
          <div class="title">帶狀皰疹後遺症強 民眾盼中市府跟進疫苗補助</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-08-11 · 大紀元記者黃玉燕台灣台中報導</div>
        </a>

        <a class="news" href="https://tw.news.yahoo.com/%E8%B7%AF%E5%8F%A3%E5%8D%81%E5%85%AC%E5%B0%BA%E7%A6%81%E5%81%9C%E6%B0%91%E6%80%A8%E7%88%AD%E8%AD%B0%E4%B8%8D%E6%96%B7-%E8%AD%B0%E5%93%A1%E7%B1%B2%E6%AA%A2%E8%A8%8E%E6%94%B9%E5%96%84-043131508.html?guccounter=1&guce_referrer=aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8&guce_referrer_sig=AQAAAADyHAV4iSJ2RGA2rpdGnvhRt_I9mVNd0Iepw_6Uap6ki5j1dZ1Td86drCUK0OUS1ewToWyYWU0Y_p6RhJSJ6TPJKL4d7Sb3vw0NadD-qUf7J66JLJZsgdvUsAjEpF0Odt9NVQzCMagTeq4Ylo2nGYHpLjFya6nZIAY8dQRbrdOO"
         target="_blank" rel="noopener noreferrer" data-category="交通 / 在地建設">
          <span class="badge">交通 / 在地建設</span>
          <div class="title">路口十公尺禁停民怨爭議不斷 議員籲檢討改善</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-08-06 · 記者孫詩蘋／台中報導</div>
        </a>

        <a class="news" href="https://tw.news.yahoo.com/%E8%B1%AA%E9%9B%A8%E9%87%80%E7%81%BD-%E9%99%B3%E9%9B%85%E6%83%A0-%E6%B1%9F%E8%82%87%E5%9C%8B%E6%8C%BA%E9%80%B2%E5%8F%B0%E5%8D%97-%E5%8D%94%E5%8A%A9%E5%B1%85%E6%B0%91%E6%B8%85%E7%90%86%E5%AE%B6%E5%9C%92-112248190.html?guccounter=1&guce_referrer=aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8&guce_referrer_sig=AQAAAFot3mrRDm3WvOGzVKPNIKI6rGuMzjmYTFzySMFV5qcJ8JuWPAKOdbrKb9S9wNxHJu8HwXJWQGMwLGmlECfiQtypBzGVzzHbp0WqNi80rHCb-pon3QcM9OrdSPZ5TMuR6lJFa97M9TR5LgAMX5aBByXzAlA3yNuX8-S1Zw3w3JwH"
         target="_blank" rel="noopener noreferrer" data-category="公共安全">
          <span class="badge">公共安全</span>
          <div class="title">豪雨釀災！陳雅惠、江肇國挺進台南 協助居民清理家園</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-08-04 · 民視新聞網</div>
        </a>

        <a class="news" href="https://www.ftvnews.com.tw/news/detail/2025720W0183"
         target="_blank" rel="noopener noreferrer" data-category="政治參與">
          <span class="badge">政治參與</span>
          <div class="title">大罷免大決戰！請不適任藍委離開國會　陳雅惠、江肇國拚了</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-07-20 · 民視新聞網</div>
        </a>

        <a class="news" href="https://video.ltn.com.tw/article/4ymRAfZmlQo/PLI7xntdRxhw1UWsgraa6LMK0szgn9mLbn"
         target="_blank" rel="noopener noreferrer" data-category="民生">
          <span class="badge">民生</span>
          <div class="title">台中市區下雪了? 木棉花棉絮四處飄</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-06-12 · 記者蘇金鳳／台中報導</div>
        </a>

        <a class="news" href="https://www.taiwanhot.net/news/focus/1103873/%E7%9B%A7%E7%A7%80%E7%87%95%E6%9C%AA%E4%BE%86%E5%8B%95%E5%90%91+%E7%B6%A0%E8%AD%B0%E5%93%A1%E9%99%B3%E9%9B%85%E6%83%A0%E8%AD%B0%E4%BA%8B%E5%A0%82%E7%9B%B4%E7%90%83%E8%BF%BD%E5%95%8F/80/%E6%94%BF%E6%B2%BB%E9%A0%BB%E9%81%93"
         target="_blank" rel="noopener noreferrer" data-category="議會 / 政策">
          <span class="badge">議會 / 政策</span>
          <div class="title">盧秀燕未來動向　綠議員陳雅惠議事堂直球追問</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-05-28 · 記者李梅金／台中報導</div>
        </a>

        <a class="news" href="https://udn.com/news/story/7321/8769683"
         target="_blank" rel="noopener noreferrer" data-category="政治參與">
          <span class="badge">政治參與</span>
          <div class="title">台中里長邊騎機車邊對議員比中指 公然侮辱判拘役20日</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-05-28 · 聯合報／ 記者曾健祐／台中即時報導</div>
        </a>

        <a class="news" href="https://news.ltn.com.tw/news/life/breakingnews/5053939"
         target="_blank" rel="noopener noreferrer" data-category="公共安全">
          <span class="badge">公共安全</span>
          <div class="title">中市「文小38」荒廢多年 議員怒批已成治安死角</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-05-25 · 記者蘇金鳳／台中報導</div>
        </a>

        <a class="news" href="https://www.ettoday.net/news/20250523/2965737.htm"
         target="_blank" rel="noopener noreferrer" data-category="民生">
          <span class="badge">民生</span>
          <div class="title">台中職災死亡5年增25人　議員籲：導入AI監控強化預警能力</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-05-23 · 記者鄧木卿／台中報導</div>
        </a>

        <a class="news" href="https://www.mypeoplevol.com/2025/yahoo/25222"
         target="_blank" rel="noopener noreferrer" data-category="議會 / 政策,民生">
          <span class="badge">議會 / 政策</span>
          <span class="badge">民生</span>
          <div class="title">垃圾車執勤頻挨罰 陳雅惠、蕭隆澤提案要求中市府速訂特種車通行規範</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-05-16 · 民眾網諸葛志一臺中報導</div>
        </a>

        <a class="news" href="https://www.ftvnews.com.tw/news/detail/2025514W0596"
         target="_blank" rel="noopener noreferrer" data-category="民生">
          <span class="badge">民生</span>
          <div class="title">中捷藍線今完成簽約　陳雅惠籲盧市府：補足東南區路網空缺</div><br>
          <div class="desc">點一下看更多</div><br>
          <div class="meta">2025-05-23 · 記者鄧木卿／台中報導</div>
        </a>

        <!-- 之後新增公告：複製其中一張，記得填好 data-category，例如：
        <a class="news" href="..." data-category="一般,新聞"> ... </a>
        -->
      </div>

      <!-- 分頁列 -->
      <nav class="pager" id="bulletin-pager" aria-label="公告分頁"></nav>
    </section>
  </main>

  <footer>
    &copy; 陳雅惠議員服務團隊<br>
    服務處地址：台中市南區正義街236號<br>
    聯絡電話：04-2282-4639
  </footer>

  <!-- ✅ 自動載入 shared/topbar.html + topbar.js；會注入導覽列並啟用手機抽屜 -->
  <script>
    (function () {
      const mountId = 'topbar-mount';
      const prefixes = ['shared/', './shared/', '../shared/', '/shared/'];
      async function tryLoad() {
        for (const p of prefixes) {
          try {
            const res = await fetch(p + 'topbar.html', { cache: 'no-store' });
            if (!res.ok) continue;
            const html = await res.text();
            const mount = document.getElementById(mountId);
            if (!mount) return;
            mount.outerHTML = html;
            const s = document.createElement('script');
            s.src = p + 'topbar.js';
            document.body.appendChild(s);
            if (!document.querySelector('link[href*="topbar.css"]')) {
              const link = document.createElement('link');
              link.rel = 'stylesheet';
              link.href = p + 'topbar.css';
              document.head.appendChild(link);
            }
            return;
          } catch (e) {}
        }
        const mount = document.getElementById(mountId);
        if (mount) {
          mount.innerHTML =
            '<div style="background:#fee;border:1px solid #f99;color:#900;padding:10px;border-radius:8px;">' +
            '無法載入 <code>shared/topbar.html</code>。請確認：<br>' +
            '1) 以伺服器方式開啟（Live Server / localhost）<br>' +
            '2) 此頁相對於 <code>/shared</code> 的路徑層級是否正確' +
            '</div>';
        }
      }
      tryLoad();
    })();
  </script>

  <!-- Hero 輪播腳本 -->
  <script>
    (function(){
      const root = document.getElementById('carousel');
      const slides = Array.from(root.querySelectorAll('.slide'));
      const prev = root.querySelector('#prev');
      const next = root.querySelector('#next');
      const dotsEl = root.querySelector('#dots');
      let i=0, timer;

      function go(n){
        slides[i].classList.remove('active'); dotsEl.children[i]?.classList.remove('active');
        i=(n+slides.length)%slides.length;
        slides[i].classList.add('active'); dotsEl.children[i]?.classList.add('active');
      }
      function auto(){ timer=setInterval(()=>go(i+1),5000); }
      function stop(){ clearInterval(timer); }

      slides.forEach((_,idx)=>{
        const d=document.createElement('button');
        d.className='dot'+(idx===0?' active':'');
        d.addEventListener('click',()=>{stop();go(idx);auto();});
        dotsEl.appendChild(d);
      });
      prev.addEventListener('click',()=>{stop();go(i-1);auto();});
      next.addEventListener('click',()=>{stop();go(i+1);auto();});
      root.addEventListener('mouseenter',stop);
      root.addEventListener('mouseleave',auto);
      auto();
    })();
  </script>

  <!-- 📣 公告：搜尋 + 分類 + 分頁（每頁 9 則） -->
  <script>
    (function(){
      const PER_PAGE = 6;                 // 固定每頁 6 則
      const list   = document.getElementById('bulletin-list');
      const cards  = Array.from(list.children);
      const search = document.getElementById('bulletin-search');
      const filter = document.getElementById('bulletin-filter');
      const pager  = document.getElementById('bulletin-pager');
      const anchorTop = () => document.getElementById('bulletin').offsetTop - 80;

      let view = { q:'', cat:'全部', page:1, filtered:cards };

      function textOf(card){
        const t = card.querySelector('.title')?.textContent || '';
        const d = card.querySelector('.desc')?.textContent || '';
        const b = card.querySelector('.badge')?.textContent || '';
        return (t + ' ' + d + ' ' + b).toLowerCase();
      }
      function categoriesOf(card){
        const raw = (card.getAttribute('data-category') || '').split(',');
        return raw.map(s => s.trim()).filter(Boolean);
      }
      function applyFilters(){
        const q = view.q.trim().toLowerCase();
        const cat = view.cat;
        view.filtered = cards.filter(c => {
          const okQ   = q ? textOf(c).includes(q) : true;
          const okCat = (cat === '全部') ? true : categoriesOf(c).includes(cat);
          return okQ && okCat;
        });
        view.page = 1;
        render();
      }

      function render(){
        // 1) 全部隱藏
        cards.forEach(c => c.style.display = 'none');

        // 2) 取出本頁要顯示的卡片
        const total = view.filtered.length;
        const pages = Math.max(1, Math.ceil(total / PER_PAGE));
        view.page = Math.min(view.page, pages);

        const start = (view.page - 1) * PER_PAGE;
        const end   = start + PER_PAGE;
        view.filtered.slice(start, end).forEach(c => c.style.display = '');

        // 3) 重繪分頁
        drawPager(pages);
      }

      function pageNum(num, current){
        const btn = document.createElement('button');
        btn.className = 'page-num' + (num === current ? ' active' : '');
        btn.textContent = num;
        btn.addEventListener('click', () => { view.page = num; render(); window.scrollTo({top: anchorTop(), behavior:'smooth'}); });
        return btn;
      }

      function drawPager(pages){
        pager.innerHTML = '';
        if (pages <= 1){ return; }

        const prev = document.createElement('button');
        prev.className = 'page-btn page-prev';
        prev.textContent = '上一頁';
        prev.disabled = (view.page === 1);
        prev.addEventListener('click', () => { if(view.page>1){ view.page--; render(); window.scrollTo({top: anchorTop(), behavior:'smooth'}); }});
        pager.appendChild(prev);

        // 頁碼（顯示：1、目前頁±1、最後頁；其餘以省略號表示）
        const current = view.page;
        const want = new Set([1, current-1, current, current+1, pages]);
        const normalized = [...Array(pages)].map((_,i)=>i+1).filter(n => want.has(n) && n>=1 && n<=pages);

        let last = 0;
        normalized.forEach(n => {
          if (n - last > 1) {
            const el = document.createElement('span');
            el.className = 'ellipsis';
            el.textContent = '…';
            pager.appendChild(el);
          }
          pager.appendChild(pageNum(n, current));
          last = n;
        });

        const next = document.createElement('button');
        next.className = 'page-btn page-next';
        next.textContent = '下一頁';
        next.disabled = (view.page === pages);
        next.addEventListener('click', () => { if(view.page<pages){ view.page++; render(); window.scrollTo({top: anchorTop(), behavior:'smooth'}); }});
        pager.appendChild(next);
      }

      // 綁事件
      search.addEventListener('input', e => { view.q = e.target.value; applyFilters(); });
      filter.addEventListener('change', e => { view.cat = e.target.value; applyFilters(); });

      // 初始顯示
      render();
    })();
  </script>
</body>
</html>
