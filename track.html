<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ¡ˆä»¶é€²åº¦æŸ¥è©¢ - é™³é›…æƒ è­°å“¡æœå‹™å¹³å°</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f9f9f9;max-width:600px;margin:auto;padding:2em;}
    h1{text-align:center;color:#00993d;}
    form{background:#fff;padding:1.5em;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.1);}
    label{display:block;margin-top:1em;font-weight:bold;}
    input{width:100%;padding:.6em;margin-top:.3em;border:1px solid #ccc;border-radius:5px;}
    button{margin-top:1.5em;padding:.8em;background:#00993d;color:#fff;border:none;border-radius:5px;width:100%;font-size:1em;}
    .result{margin-top:1.5em;padding:1em;background:#e8f4ff;border:1px solid #a6c8ff;border-radius:5px;display:none;}
    footer{text-align:center;margin-top:2em;color:#777;font-size:.9em;}
  </style>
</head>
<body>

<h1>ğŸ“„ æ¡ˆä»¶é€²åº¦æŸ¥è©¢</h1>
<p style="text-align:center;">è«‹è¼¸å…¥æ‚¨å¡«å¯«è¡¨å–®æ™‚çš„é›»å­ä¿¡ç®±èˆ‡æ¡ˆä»¶ç·¨è™Ÿ</p>

<form id="trackForm" onsubmit="handleSearch(event)">
  <label for="email">é›»å­ä¿¡ç®±</label>
  <input type="email" id="email" required />

  <label for="caseid">æ¡ˆä»¶ç·¨è™Ÿ</label>
  <input type="text" id="caseid" required />

  <button type="submit">æŸ¥è©¢æ¡ˆä»¶</button>
</form>

<div id="result" class="result">
  <strong>æŸ¥è©¢çµæœï¼š</strong>
  <p id="resultText">ï¼ˆé€™è£¡æœƒé¡¯ç¤ºæŸ¥è©¢åˆ°çš„æ¡ˆä»¶ç‹€æ…‹ï¼‰</p>
</div>

<footer>
  Â©â€¯2025â€¯é™³é›…æƒ è­°å“¡æœå‹™åœ˜éšŠï½œè¯çµ¡é›»è©±ï¼š04â€‘2282â€‘4639
</footer>

<script>
/* æŠŠå­—ä¸²ï¼štrim â†’ å…¨å½¢è½‰åŠå½¢ â†’ å°å¯« */
function normalize(str){
  if(!str) return '';
  // å…¨å½¢è½‰åŠå½¢
  const s = str.trim().replace(/[ï¼-ï½]/g,ch =>
    String.fromCharCode(ch.charCodeAt(0)-0xFEE0)
  ).replace('ã€€',' ');               // å…¨å½¢ç©ºç™½
  return s.toLowerCase();
}

async function handleSearch(e){
  e.preventDefault();
  const email  = normalize(document.getElementById('email').value);
  const caseId = normalize(document.getElementById('caseid').value);

  const box = document.getElementById('result');
  const txt = document.getElementById('resultText');

  try{
    const res  = await fetch('https://opensheet.elk.sh/1_mUxHK6iXozkkeyZ8YV82AUUe0BQe4uqc-blRuD6yhU/progress');
    const data = await res.json();

    const row = data.find(r =>
      normalize(r['æ¡ˆä»¶ç·¨è™Ÿ']) === caseId &&
      normalize(r['é›»å­ä¿¡ç®±']) === email
    );

    if(row){
      const note = (row['å‚™è¨»']||'').replaceAll('\\n','<br/>');
      txt.innerHTML = `ğŸ” æ¡ˆä»¶ç‹€æ…‹ï¼š<strong>${row['æ¡ˆä»¶ç‹€æ…‹']}</strong><br/>ğŸ“ å‚™è¨»ï¼š${note||'â€”'}`;
    }else{
      txt.innerHTML = '<span style="color:red;">æŸ¥ç„¡æ­¤æ¡ˆä»¶ï¼Œè«‹ç¢ºèªè¼¸å…¥æ­£ç¢ºï¼ˆè«‹ä½¿ç”¨åŠå½¢è‹±æ•¸ï¼‰ã€‚</span>';
    }
    box.style.display='block';
  }catch(err){
    txt.innerHTML = '<span style="color:red;">ç„¡æ³•è®€å–è³‡æ–™ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</span>';
    box.style.display='block';
  }
}
</script>

</body>
</html>
